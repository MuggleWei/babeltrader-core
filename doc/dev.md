# babeltrader core dev
babeltrader库开发手册

## 消息
babeltrader当中, 消息分为两个大类, 网络消息(network message)和事件消息(event message)

### 网络消息
特别需要注意, babeltrader网络消息具体使用的端序取决于配置, 默认情况下使用本地机器端序而不是通常的网络字节序(大端序). 之所以这么设计, 是因为作为交易系统内部服务, 通常可以假定所有的机器是使用相同的端序, 忽略端序可以节省内部穿透到耗时.   
所有的消息均包含消息头NetworkMessage, 当前版本消息头结构如下
```
|   4 bytes    |     4 bytes    |
| message type | payload length |
```

* message type: 表示消息id
* payload length: 表示消息携带数据的长度(不包含消息头的长度)

### 事件消息
事件消息是用户最终看到的结构体及其附带信息(例如会话信息, 消息池信息), 当网络消息到达时, 最终会被转换为事件消息. 这对使用的用户来说是透明的, 用户最终的回调函数中, 只会看到统一的结构体.

## 消息id
消息id枚举量分为三个部分: common, api以及专有api. 消息枚举量数值段分布如下
```
--------------
common消息 (0 - N1)
--------------
api消息 (N1 - N2)
--------------
专有api消息 (N2 - N3)
--------------
```
其中N1, N2, N3表示数值, 各个专有api消息的枚举量可互相重叠

### common消息枚举量
common消息枚举量包含通用消息, 例如base库中需要使用到的消息id

### api消息枚举量
api消息枚举量是通用的消息id, 在每个服务以及api中都可使用

### 专有api消息枚举量
仅在上手服务及其对应的api之间传递的消息
